<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bartolelli - Colombo - Cuesta">
<meta name="dcterms.date" content="2022-12-31">

<title>today - Análisis de la Variancia (ANOVA)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">today</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Análisis de la Variancia (ANOVA)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bartolelli - Colombo - Cuesta </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 31, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div style="text-align: justify">

<section id="comparación-de-dos-promedios-poblacionales" class="level1">
<h1>Comparación de dos promedios poblacionales</h1>
<p>Análisis comparativo en el que se presenta un <strong>factor con dos niveles</strong>. Cada nivel se refiere a una población diferente. El objetivo es comparar esas poblaciones en función de una <strong>variable (respuesta) continua y gaussiana</strong>.</p>
<p>Los datos corresponden a una muestra de deportistas federados, de 18 a 22 años, que entrenan y compiten en distintos clubes de la ciudad de Rosario. Se desea conocer si en promedio los hombres tienden a realizar el “Test de Coordinación de 4 tramos de 10 metros cada uno” en menos tiempo (segundos) que las mujeres.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
     id sexo     club                                     deporte   coord saltar
  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;                                    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1     1 Femenino CLUB DEPORTIVO Y SOCIAL SPORTSMEN UNIDOS Volleyba…  15       32
2     2 Femenino CLUB DEPORTIVO Y SOCIAL SPORTSMEN UNIDOS Volleyba…  15.4     39
3     3 Femenino CLUB DEPORTIVO Y SOCIAL SPORTSMEN UNIDOS Volleyba…  16.3     32
4     4 Femenino CLUB ATLETICO PROVINCIAL                 Volleyba…  16.0     45
5     5 Femenino NOB                                      Volleyba…  15.2     37
6     6 Femenino CLUB ATLETICO PROVINCIAL                 Volleyba…  15.1     51</code></pre>
</div>
</div>
<p>En primer lugar, se debe evaluar el cumplimiento de normalidad en ambas poblaciones/muestra/grupos. Se puede comprobar gráficamente a partir de histogramas y también a través de la prueba de Shapiro-Wilks, en el cual se prueba <span class="math inline">\(H_0) Y \sim \mathcal{N}(\mu,\sigma^2)\)</span> versus <span class="math inline">\(H_1) Y \nsim \mathcal{N}(\mu,\sigma^2)\)</span>. La variable respuesta <em>Y</em> representa el tiempo (en segundos) que tarda un deportista en realizar el test de coordinación.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/histogramas-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(base<span class="sc">$</span>coord[base<span class="sc">$</span>sexo<span class="sc">==</span><span class="st">'Femenino'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  base$coord[base$sexo == "Femenino"]
W = 0.99027, p-value = 0.4983</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(base<span class="sc">$</span>coord[base<span class="sc">$</span>sexo<span class="sc">==</span><span class="st">'Masculino'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  base$coord[base$sexo == "Masculino"]
W = 0.99461, p-value = 0.8573</code></pre>
</div>
</div>
<p>En este caso, se concluye que en base a la evidencia muestral y con un nivel de significación del <span class="math inline">\(5\%\)</span> ambas poblaciones se distribuyen de manera normal.</p>
<p>Luego, se estudian medidas descriptivas y gráfico de boxplots para ambos grupos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticas descriptivas</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>base <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">media =</span> <span class="fu">mean</span>(coord),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">desvio =</span> <span class="fu">sd</span>(coord)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  sexo          n media desvio
  &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Femenino    130  15.8   1.22
2 Masculino   149  14.0   1.30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(base, <span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> coord)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="co"># Bigotes</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#4271AE"</span>, <span class="at">colour =</span> <span class="st">"#1F3552"</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Boxplots de los tiempos en realizar el test de coordinación según sexo"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Tiempo (en segundos)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se puede observar que los tiempos en realizar el test de coordinación en mujeres son levemente mayores que los tiempos obtenidos por los varones. A continuación, se evaluará si esta diferencia es significativa.</p>
<p>Antes de llevar a cabo la prueba de igualdad de medias, se debe chequear si las variancias entre grupos son iguales: <span class="math inline">\(H_0) \sigma_F^2=\sigma_M^2\)</span> versus <span class="math inline">\(H_1) \sigma_F^2 \neq \sigma_M^2\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de igualdad de variancias</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(coord <span class="sc">~</span> sexo, base, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  coord by sexo
F = 0.88103, num df = 129, denom df = 148, p-value = 0.4611
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.6313037 1.2343574
sample estimates:
ratio of variances 
         0.8810328 </code></pre>
</div>
</div>
<p>Se cumple la igualdad de variancias, por lo que se postula la prueba de igualdad de medias: <span class="math inline">\(H_0) \mu_F=\mu_M\)</span> versus <span class="math inline">\(H_1) \mu_F &gt; \mu_M\)</span>.</p>
<ul>
<li>1º enfoque: Prueba “t de student”</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de medias</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(coord <span class="sc">~</span> sexo, base, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  coord by sexo
t = 11.846, df = 277, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group Femenino and group Masculino is greater than 0
95 percent confidence interval:
 1.540192      Inf
sample estimates:
 mean in group Femenino mean in group Masculino 
               15.79131                14.00181 </code></pre>
</div>
</div>
<ul>
<li>2º enfoque: ANOVA</li>
</ul>
<p>Se postula el siguiente modelo de efectos fijos: <span class="math inline">\(y_{ij} = \mu + \tau_i + e_{ij}, \ i=\overline{1,2} \ \land \ j=\overline{1,n_i}\)</span>, donde:</p>
<pre><code>-   $y_{ij} =$ resultado del test de coordinación del deportista $j$ del grupo $i$.

-   $\mu =$ valor de referencia del test de coordinación.

-   $\tau_i =$ efecto grupo $i$.

-   $e_{ij} =$ error aleatorio del deportista $j$ del grupo $i$.</code></pre>
<p>Además, <span class="math inline">\(e_{ij} \sim \mathcal{N}(0,\sigma^2)\)</span> <em>e independientes.</em></p>
<p>A continuación, se muestra la tabla ANOVA:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla ANOVA</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(coord<span class="sc">~</span>sexo, base)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
sexo          1  222.3  222.32   140.3 &lt;2e-16 ***
Residuals   277  438.8    1.58                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Para ambos enfoques, se obtiene que en base a la evidencia muestral y con un nivel de significación del <span class="math inline">\(5\%\)</span>, se rechaza la hipótesis nula, es decir, en promedio a las mujeres les lleva más tiempo realizar el test de coordinación que a los hombres.</p>
</section>
<section id="anova-para-un-criterio-de-clasificación" class="level1">
<h1>ANOVA para un criterio de clasificación</h1>
<p>Análisis comparativo en el que se presenta un <strong>factor de clasificación con dos o más niveles</strong>. Cada nivel se refiere a una población diferente. El objetivo es comparar dichas poblaciones en función de una <strong>variable (respuesta) continua y gaussiana</strong> a través de un <strong>Análisis de la Variancia</strong> (ANOVA).</p>
<p>Los datos brindados corresponden a una muestra de deportistas federados, de 18 a 22 años, que entrenan y compiten en deportes y clubes diferentes de la ciudad de Rosario. Se desea conocer si existen diferencias significativas en el resultado medio del “test de Coordinación en 4 tramos de 10 metros cada tramo” entre los grupos de deportistas. Los cuatro grupos comparados están conformados de la siguiente manera:</p>
<ul>
<li>Grupo 1: deportistas jugadores de basquetball del Club Atlético Libertad</li>
<li>Grupo 2: deportistas jugadores de volleyball del Club Atlético Libertad</li>
<li>Grupo 3: deportistas jugadores de basquetball del Club Atlético Provincial</li>
<li>Grupo 4: deportistas jugadores de volleyball del Club Atlético Provincial</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base_grupos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id sexo      club                     deporte    coord saltar grupos       
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        
1     4 Femenino  CLUB ATLETICO PROVINCIAL Volleyball  16.0     45 CAProvincial…
2     6 Femenino  CLUB ATLETICO PROVINCIAL Volleyball  15.1     51 CAProvincial…
3     8 Masculino CLUB ATLETICO PROVINCIAL Volleyball  14.7     53 CAProvincial…
4    11 Masculino CLUB ATLETICO PROVINCIAL Volleyball  14.2     43 CAProvincial…
5    12 Femenino  CLUB ATLETICO PROVINCIAL Volleyball  18.6     49 CAProvincial…
6    13 Femenino  CLUB ATLETICO PROVINCIAL Volleyball  17.6     41 CAProvincial…</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(base_grupos<span class="sc">$</span>grupos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  CALibertad-basquetball    CALibertad-volleyball CAProvincial-basquetball 
                      14                       12                       14 
 CAProvincial-volleyball 
                      29 </code></pre>
</div>
</div>
<p>Se evalua el cumplimiento de normalidad en los grupos en estudio. Se puede comprobar a través de la prueba de Shapiro-Wilks, en el cual se prueba <span class="math inline">\(H_0) Y \sim \mathcal{N}(\mu,\sigma^2)\)</span> versus <span class="math inline">\(H_1) Y \nsim \mathcal{N}(\mu,\sigma^2)\)</span>. La variable respuesta <em>Y</em> representa el tiempo (en segundos) que tarda un deportista en realizar el test de coordinación.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(base_grupos<span class="sc">$</span>coord[base_grupos<span class="sc">$</span>grupos<span class="sc">==</span><span class="st">'CALibertad-basquetball'</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  base_grupos$coord[base_grupos$grupos == "CALibertad-basquetball"]
W = 0.95211, p-value = 0.594</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(base_grupos<span class="sc">$</span>coord[base_grupos<span class="sc">$</span>grupos<span class="sc">==</span><span class="st">'CALibertad-volleyball'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  base_grupos$coord[base_grupos$grupos == "CALibertad-volleyball"]
W = 0.92313, p-value = 0.3129</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(base_grupos<span class="sc">$</span>coord[base_grupos<span class="sc">$</span>grupos<span class="sc">==</span><span class="st">'CAProvincial-basquetball'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  base_grupos$coord[base_grupos$grupos == "CAProvincial-basquetball"]
W = 0.9574, p-value = 0.6801</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(base_grupos<span class="sc">$</span>coord[base_grupos<span class="sc">$</span>grupos<span class="sc">==</span><span class="st">'CAProvincial-volleyball'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  base_grupos$coord[base_grupos$grupos == "CAProvincial-volleyball"]
W = 0.96929, p-value = 0.5407</code></pre>
</div>
</div>
<p>En este caso, se concluye que en base a la evidencia muestral y con un nivel de significación del <span class="math inline">\(5\%\)</span> las poblaciones se distribuyen de manera normal.</p>
<p>Luego, se estudian medidas descriptivas y gráfico de boxplots para los cuatro grupos de deportistas.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticas descriptivas</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>base_grupos <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(grupos) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">media =</span> <span class="fu">mean</span>(coord),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">desvio =</span> <span class="fu">sd</span>(coord)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  grupos                       n media desvio
  &lt;chr&gt;                    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 CALibertad-basquetball      14  14.5  1.02 
2 CALibertad-volleyball       12  16.3  1.02 
3 CAProvincial-basquetball    14  14.6  0.493
4 CAProvincial-volleyball     29  16.5  1.15 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(base_grupos, <span class="fu">aes</span>(<span class="at">x =</span> grupos, <span class="at">y =</span> coord)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#4271AE"</span>, <span class="at">colour =</span> <span class="st">"#1F3552"</span>, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Boxplots de los tiempos en realizar el test de coordinación según grupo de deportistas"</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Tiempo (en segundos)"</span>, <span class="at">x=</span><span class="st">"Grupos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se puede observar que los tiempos en realizar el test de coordinación difieren dependiendo del grupo de deportistas. A continuación, se evaluará si esta diferencia es significativa.</p>
<p>Se plantea el siguiente modelo de efectos fijos: <span class="math inline">\(y_{ij} = \mu + \tau_i + e_{ij}, \ i=\overline{1,a} \ \land \ j=\overline{1,n_i}\)</span>, donde:</p>
<ul>
<li><p><span class="math inline">\(y_{ij} =\)</span> resultado del test de coordinación del deportista <span class="math inline">\(j\)</span> del grupo <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(\mu =\)</span> valor de referencia del test de coordinación.</p></li>
<li><p><span class="math inline">\(\tau_i =\)</span> efecto grupo <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(e_{ij} =\)</span> error aleatorio del deportista <span class="math inline">\(j\)</span> del grupo <span class="math inline">\(i\)</span>.</p></li>
</ul>
<p>Además, <span class="math inline">\(e_{ij} \sim \mathcal{N}(0,\sigma^2)\)</span> <em>e independientes.</em></p>
<p>A continuación, se muestra la tabla ANOVA:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla ANOVA</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(coord<span class="sc">~</span>grupos, base_grupos)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
grupos       3  58.78  19.594   19.53 3.88e-09 ***
Residuals   65  65.21   1.003                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>El test de hipótesis para responder al objetivo resulta: <span class="math inline">\(H_0) \tau_a = \tau_b =\tau_c =\tau_d\)</span> versus <span class="math inline">\(H_1) Al \ menos \ un \ \tau_i \neq del \ resto, i=\overline{1,a}\)</span>.</p>
<p>En base a la evidencia muestral y con un nivel de significación del <span class="math inline">\(5\%\)</span>, se rechaza la hipótesis nula, es decir, existen diferencias signficativas en los tiempos que les lleva realizar el test de coordinación en al menos uno de los grupos de deportistas.</p>
<section id="comparaciones-múltiples" class="level2">
<h2 class="anchored" data-anchor-id="comparaciones-múltiples">Comparaciones múltiples</h2>
<p>El problema sobre la comparación de varios grupos que se resuelve a través del ANOVA es interesante y útil, pero no siempre suficiente. En caso de rechazar la hipótesis nula, se concluirá que no todos los tratamientos tienen los mismos promedios poblacionales pero, seguramente, el investigador querrá saber cuál o cuáles son los promedios diferentes o cuáles son iguales entre sí.</p>
<p>Para conocer entre cuales grupos se presentan las diferencias se utilizará el procedimiento de <strong>Comparaciones múltiples</strong>, el cual tiene como objetivo dar respuesta a las siguientes hipótesis (una vez que se rechazó la igualdad de medias de tratamientos con la prueba F del ANOVA): <span class="math inline">\(H_0) \mu_i = \mu_{i'}\)</span> versus <span class="math inline">\(H_1) \mu_i \neq \mu_{i'}, \ i \neq i' \ \land i,i'=\overline{1,a}\)</span>.</p>
<p>Se compararán los grupos de deportistas estudiados en la sección 2 de ANOVA para un criterio de clasificación.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librería</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se ajusta el modelo para los datos tal como se planteó en la sección 2 (<span class="math inline">\(y_{ij} = \mu + \tau_i + e_{ij}, \ i=\overline{1,a} \ \land \ j=\overline{1,n_i}\)</span>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(coord<span class="sc">~</span>grupos, base_grupos)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = coord ~ grupos, data = base_grupos)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2445 -0.5650  0.0350  0.7055  2.3233 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     14.4914     0.2677  54.133  &lt; 2e-16 ***
gruposCALibertad-volleyball      1.8152     0.3940   4.607 1.96e-05 ***
gruposCAProvincial-basquetball   0.1036     0.3786   0.274    0.785    
gruposCAProvincial-volleyball    1.9731     0.3260   6.053 7.86e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.002 on 65 degrees of freedom
Multiple R-squared:  0.4741,    Adjusted R-squared:  0.4498 
F-statistic: 19.53 on 3 and 65 DF,  p-value: 3.877e-09</code></pre>
</div>
</div>
<p>Se presentan algunos métodos para dar respuesta a nuestra prueba de hipótesis.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método de la diferencia mínima significativa (LSD: Least Significant Difference)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>LSD <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(modelo, <span class="st">"grupos"</span>, <span class="at">p.adj =</span> <span class="st">"none"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>LSD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df     Mean      CV
   1.0033 65 15.65739 6.39729

$parameters
        test p.ajusted name.t ntr alpha
  Fisher-LSD      none grupos   4  0.05

$means
                            coord       std  r        se      LCL      UCL
CALibertad-basquetball   14.49143 1.0188218 14 0.2677019 13.95679 15.02607
CALibertad-volleyball    16.30667 1.0220953 12 0.2891511 15.72919 16.88414
CAProvincial-basquetball 14.59500 0.4933987 14 0.2677019 14.06036 15.12964
CAProvincial-volleyball  16.46448 1.1505328 29 0.1860015 16.09301 16.83595
                           Min   Max    Q25    Q50     Q75
CALibertad-basquetball   12.35 16.20 14.125 14.510 14.8600
CALibertad-volleyball    15.10 18.63 15.505 16.165 16.8575
CAProvincial-basquetball 13.66 15.36 14.205 14.725 14.9350
CAProvincial-volleyball  14.22 18.61 15.930 16.590 17.3600

$comparison
NULL

$groups
                            coord groups
CAProvincial-volleyball  16.46448      a
CALibertad-volleyball    16.30667      a
CAProvincial-basquetball 14.59500      b
CALibertad-basquetball   14.49143      b

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método (prueba) de Duncan</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>duncan <span class="ot">&lt;-</span> <span class="fu">duncan.test</span>(modelo, <span class="st">"grupos"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>duncan </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df     Mean      CV
   1.0033 65 15.65739 6.39729

$parameters
    test name.t ntr alpha
  Duncan grupos   4  0.05

$duncan
NULL

$means
                            coord       std  r        se   Min   Max    Q25
CALibertad-basquetball   14.49143 1.0188218 14 0.2677019 12.35 16.20 14.125
CALibertad-volleyball    16.30667 1.0220953 12 0.2891511 15.10 18.63 15.505
CAProvincial-basquetball 14.59500 0.4933987 14 0.2677019 13.66 15.36 14.205
CAProvincial-volleyball  16.46448 1.1505328 29 0.1860015 14.22 18.61 15.930
                            Q50     Q75
CALibertad-basquetball   14.510 14.8600
CALibertad-volleyball    16.165 16.8575
CAProvincial-basquetball 14.725 14.9350
CAProvincial-volleyball  16.590 17.3600

$comparison
NULL

$groups
                            coord groups
CAProvincial-volleyball  16.46448      a
CALibertad-volleyball    16.30667      a
CAProvincial-basquetball 14.59500      b
CALibertad-basquetball   14.49143      b

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método de Student-Newman-Keuls</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>snk <span class="ot">&lt;-</span> <span class="fu">SNK.test</span>(modelo, <span class="st">"grupos"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>snk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df     Mean      CV
   1.0033 65 15.65739 6.39729

$parameters
  test name.t ntr alpha
   SNK grupos   4  0.05

$snk
NULL

$means
                            coord       std  r        se   Min   Max    Q25
CALibertad-basquetball   14.49143 1.0188218 14 0.2677019 12.35 16.20 14.125
CALibertad-volleyball    16.30667 1.0220953 12 0.2891511 15.10 18.63 15.505
CAProvincial-basquetball 14.59500 0.4933987 14 0.2677019 13.66 15.36 14.205
CAProvincial-volleyball  16.46448 1.1505328 29 0.1860015 14.22 18.61 15.930
                            Q50     Q75
CALibertad-basquetball   14.510 14.8600
CALibertad-volleyball    16.165 16.8575
CAProvincial-basquetball 14.725 14.9350
CAProvincial-volleyball  16.590 17.3600

$comparison
NULL

$groups
                            coord groups
CAProvincial-volleyball  16.46448      a
CALibertad-volleyball    16.30667      a
CAProvincial-basquetball 14.59500      b
CALibertad-basquetball   14.49143      b

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método Tukey o de la “Diferencia Honestamente Significativa (HSD)”</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>hsd <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(modelo, <span class="st">"grupos"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>hsd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df     Mean      CV
   1.0033 65 15.65739 6.39729

$parameters
   test name.t ntr StudentizedRange alpha
  Tukey grupos   4         3.728941  0.05

$means
                            coord       std  r        se   Min   Max    Q25
CALibertad-basquetball   14.49143 1.0188218 14 0.2677019 12.35 16.20 14.125
CALibertad-volleyball    16.30667 1.0220953 12 0.2891511 15.10 18.63 15.505
CAProvincial-basquetball 14.59500 0.4933987 14 0.2677019 13.66 15.36 14.205
CAProvincial-volleyball  16.46448 1.1505328 29 0.1860015 14.22 18.61 15.930
                            Q50     Q75
CALibertad-basquetball   14.510 14.8600
CALibertad-volleyball    16.165 16.8575
CAProvincial-basquetball 14.725 14.9350
CAProvincial-volleyball  16.590 17.3600

$comparison
NULL

$groups
                            coord groups
CAProvincial-volleyball  16.46448      a
CALibertad-volleyball    16.30667      a
CAProvincial-basquetball 14.59500      b
CALibertad-basquetball   14.49143      b

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<p>Para cualquiera de los métodos presentados, se concluye que con un nivel de significación del 5%, los tiempos medios en realizar el test de coordinación difieren para los deportistas de distintos deportes (basquetball-volleyball), y no difieren entre diferentes clubes (CAL-CAP).</p>
</section>
<section id="comprobación-de-supuestos" class="level2">
<h2 class="anchored" data-anchor-id="comprobación-de-supuestos">Comprobación de supuestos</h2>
<p>La validez de las inferencias extraídas a partir del modelo y su correspondiente ANOVA, las pruebas de hipótesis y los intervalos de confianza, se basan en el cumplimiento de los supuestos postulados. Si el modelo es de efectos fijos, se postula el supuesto de independencia, normalidad e igualdad de variancias para los errores aleatorios.</p>
<p>Como los errores del modelo son desconocidos, la verificación de los mismos se realiza sobre una estimación de esos errores, los que habitualmente denominamos residuos. Se utilizarán los <strong>residuos ordinarios</strong> (<span class="math inline">\(\hat e_{ij} = y_{ij}-\bar y_{i.}\)</span>) y los <strong>residuos estandarizados</strong> (<span class="math inline">\(w_{ij} = \frac{\hat e_{ij}}{\sqrt{CME}}\)</span>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuos ordinarios y estandarizados</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>base_grupos<span class="sc">$</span>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelo)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>base_grupos<span class="sc">$</span>res_est <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>Normalidad</strong></li>
</ul>
<p>La normalidad de los residuos se puede probar a través de técnicas gráficas (qq-plot, histogramas) y también a partir de pruebas de hipótesis (Shapiro-Wilks, Lilliefors).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># qq-plot de cuantiles empíricos versus cuantiles teóricos</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(base_grupos,<span class="fu">aes</span>(<span class="at">sample=</span>res)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Shapiro-Wilks (H0) Los errores se distribuyen normales)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(base_grupos<span class="sc">$</span>res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  base_grupos$res
W = 0.98772, p-value = 0.737</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Lilliefors (H0) Los errores se distribuyen normales)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest) </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(base_grupos<span class="sc">$</span>res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  base_grupos$res
D = 0.061547, p-value = 0.7458</code></pre>
</div>
</div>
<ul>
<li><strong>Homocedasticidad (variancia constante)</strong></li>
</ul>
<p>La homocedasticidad de los residuos se puede probar a través de técnicas gráficas (residuos versus valores predichos) y también a partir de pruebas de hipótesis (Levene, Bartlett).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de w_ij vs. predichos</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(base_grupos, <span class="fu">aes</span>(<span class="at">x=</span>grupos, <span class="at">y=</span>res_est)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Levene (H0) Todas las vcias son iguales vs. H1) Al menos una distina del resto)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(base_grupos<span class="sc">$</span>res_est, <span class="at">group =</span> base_grupos<span class="sc">$</span>grupos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  3  2.1288 0.1051
      65               </code></pre>
</div>
</div>
<ul>
<li><strong>Independencia</strong></li>
</ul>
<p>La independencia de los errores se estudia a partir de la lógica del problema. En la práctica, por lo general, no se puede verificar debido a que no existe un orden temporal en las observaciones, en tal caso suele ser útil graficar los residuos en función del orden (o momento) en que fue recolectado el dato.</p>
<p>Como este supuesto es difícilmente remediable, es necesario poner mucho esfuerzo en el momento de obtener los datos.</p>
<p>Para nuestro ejemplo, se cumplen los supuestos de normalidad y homocedasticidad. En el caso de que alguno de ellos no se cumpla, se debería recurrir a alguno de los siguientes métodos:</p>
<ul>
<li>Transformaciones: Logarítmica, Raíz Cuadrada, etcétera.</li>
<li>Técnicas no paramétricas: Friedman, Kruskal-Wallis.</li>
<li>Modelos Lineales Generalizados.</li>
</ul>
</section>
<section id="base-deportistas.xlsx" class="level2">
<h2 class="anchored" data-anchor-id="base-deportistas.xlsx">Base deportistas.xlsx</h2>
<p>En <a href="https://github.com/florcolombo/Anova/blob/main/base_deportistas.xlsx">este link</a> encontrarás la base de datos utilizada para los ejemplos mostrados.</p>
</section>
</section>
<section id="anova-para-dos-criterios-de-clasificación-cruzados-sin-interacción" class="level1">
<h1>ANOVA para dos criterios de clasificación cruzados sin interacción</h1>
<p>Análisis en el que se presentan dos <strong>factores de clasificación (con dos o más niveles cada uno)</strong>. El término <em>cruzado</em> indica que cada nivel de un factor puede combinarse con cada nivel del otro factor. El objetivo es conocer si estos factores influyen en el comportamiento de una <strong>variable (respuesta) continua y gaussiana</strong> a través de un <strong>Análisis de la Variancia</strong> (ANOVA).</p>
<p>Los datos brindados corresponden a una muestra de deportistas federados, de 18 a 22 años de la ciudad de Rosario. Se desea conocer si existen diferencias significativas en el resultado medio del “test de Coordinación en 4 tramos de 10 metros cada tramo” entre los deportistas teniendo en cuenta el deporte en el que compiten y el club en el que se entrenan.</p>
<ul>
<li>Factor 1: Deporte (Volleyball-Básquetball)</li>
<li>Factor 2: Club (Club Atlético Libertad-Club Atlético Provincial)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base_factores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id sexo      club                     deporte    coord saltar grupos       
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        
1     4 Femenino  CLUB ATLETICO PROVINCIAL Volleyball  16.0     45 CAProvincial…
2     6 Femenino  CLUB ATLETICO PROVINCIAL Volleyball  15.1     51 CAProvincial…
3     8 Masculino CLUB ATLETICO PROVINCIAL Volleyball  14.7     53 CAProvincial…
4    11 Masculino CLUB ATLETICO PROVINCIAL Volleyball  14.2     43 CAProvincial…
5    12 Femenino  CLUB ATLETICO PROVINCIAL Volleyball  18.6     49 CAProvincial…
6    13 Femenino  CLUB ATLETICO PROVINCIAL Volleyball  17.6     41 CAProvincial…</code></pre>
</div>
</div>
<p>Se estudian medidas descriptivas y gráficos de boxplots y perfiles para los deportistas según deporte y club.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Medidas descriptivas</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>base_factores <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(deporte, club) <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">media =</span> <span class="fu">mean</span>(coord),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">desvio =</span> <span class="fu">sd</span>(coord)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   deporte [2]
  deporte    club                         n media desvio
  &lt;chr&gt;      &lt;chr&gt;                    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Básquetbol CLUB ATLETICO PROVINCIAL    14  14.6  0.493
2 Básquetbol CLUB ATLÉTICO LIBERTAD      14  14.5  1.02 
3 Volleyball CLUB ATLETICO PROVINCIAL    29  16.5  1.15 
4 Volleyball CLUB ATLÉTICO LIBERTAD      12  16.3  1.02 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(base_factores, <span class="fu">aes</span>(<span class="at">x =</span> deporte, <span class="at">y =</span> coord)) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>club) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#4271AE"</span>, <span class="at">colour =</span> <span class="st">"#1F3552"</span>, </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Resultado del test"</span>, <span class="at">x=</span><span class="st">"Deporte"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de perfiles (para evaluar interacción entre factores)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>base_factores <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(deporte, club) <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">media =</span> <span class="fu">mean</span>(coord)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>deporte,<span class="at">y=</span>media,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">group=</span>club,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span>club)) <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Media"</span>, <span class="at">x=</span><span class="st">"Deporte"</span>,<span class="at">color=</span><span class="st">"Club"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se puede observar que los tiempos en realizar el test de coordinación difieren dependiendo del deporte que practican los deportistas, los jugadores de basquetball en promedio realizan el test más rapidamente que los jugadores de volleyball. Con respecto al club, no parece haber diferencias entre los deportistas de clubes distintos.</p>
<p>Se plantea el siguiente modelo de efectos fijos:<br>
</p>
<p><span class="math inline">\(y_{ijk} = \mu + \tau_i + \beta_j + (\tau \beta)_{ij} + e_{ijk}, \ i=\overline{1,2} \ \land \ j=\overline{1,2}\ \land \ k=\overline{1,n_i}\)</span>, donde:</p>
<ul>
<li><p><span class="math inline">\(y_{ijk}\)</span>: resultado en el test de coordinación del <span class="math inline">\(k-ésimo\)</span> deportista que entrena en <span class="math inline">\(j\)</span> el deporte <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(\mu\)</span>: valor de referencia del resultado del test de coordinación.</p></li>
<li><p><span class="math inline">\(\tau_i\)</span>: efecto deporte <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(\tau_i\)</span>: efecto club <span class="math inline">\(j\)</span>.</p></li>
<li><p><span class="math inline">\((\tau \beta)_{ij}\)</span>: efecto interacción entre el deporte <span class="math inline">\(i\)</span> y el club <span class="math inline">\(j\)</span>.</p></li>
<li><p><span class="math inline">\(e_{ijk}\)</span>: error aleatorio del <span class="math inline">\(k-ésimo\)</span> deportista que entrena en <span class="math inline">\(j\)</span> el deporte <span class="math inline">\(i\)</span>.</p></li>
</ul>
<p>Además, <span class="math inline">\(e_{ijk} \sim \mathcal{N}(0,\sigma^2)\)</span> <em>e independientes.</em></p>
<p>En este modelo, a través de la interacción, se postula que el efecto de deporte en el resultado del test de coordinación de los deportistas depende del club.</p>
<p>A continuación, se muestra la tabla ANOVA:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla ANOVA</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(coord<span class="sc">~</span>deporte<span class="sc">*</span>club, base_factores)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
deporte       1  58.50   58.50  58.304 1.3e-10 ***
club          1   0.28    0.28   0.274   0.602    
deporte:club  1   0.01    0.01   0.011   0.916    
Residuals    65  65.21    1.00                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo estimado</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(coord<span class="sc">~</span>deporte<span class="sc">*</span>club, base_factores)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = coord ~ deporte * club, data = base_factores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2445 -0.5650  0.0350  0.7055  2.3233 

Coefficients:
                                               Estimate Std. Error t value
(Intercept)                                    14.49143    0.26770  54.133
deporteVolleyball                               1.81524    0.39405   4.607
clubCLUB ATLETICO PROVINCIAL                    0.10357    0.37859   0.274
deporteVolleyball:clubCLUB ATLETICO PROVINCIAL  0.05424    0.51140   0.106
                                               Pr(&gt;|t|)    
(Intercept)                                     &lt; 2e-16 ***
deporteVolleyball                              1.96e-05 ***
clubCLUB ATLETICO PROVINCIAL                      0.785    
deporteVolleyball:clubCLUB ATLETICO PROVINCIAL    0.916    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.002 on 65 degrees of freedom
Multiple R-squared:  0.4741,    Adjusted R-squared:  0.4498 
F-statistic: 19.53 on 3 and 65 DF,  p-value: 3.877e-09</code></pre>
</div>
</div>
<p>El test de hipótesis para responder al efecto interacción se plantea como: <span class="math inline">\(H_0)\)</span> No hay interacción versus <span class="math inline">\(H_1)\)</span> Hay interacción. Que no haya interacción es que el efecto deporte es el mismo para cualquier club: <span class="math inline">\(\mu_{11} - \mu_{21} = \mu_{12} - \mu_{22}\)</span>, luego la hipótesis en términos de los parámetros resulta: <span class="math inline">\(H_0) \mu_{11} - \mu_{21} = \mu_{12} - \mu_{22}\)</span></p>
<p>En base a la evidencia muestral y con un nivel de significación del <span class="math inline">\(5\%\)</span>, no se rechaza la hipótesis nula, es decir, no hay efecto interacción entre deporte y club. El efecto del deporte sobre el cambio del resultado del test de coordinación de los deportistas no depende del club en el que entrenan.</p>
<p>Como la interacción del modelo no resultó significativa, se puede proceder a probar que sucede con los efectos principales, a partir de las siguientes hipótesis:</p>
<ul>
<li><p>Efecto Deporte: <span class="math inline">\(H_0) \ \tau_{1} = \tau_{2}\)</span> vs.&nbsp;<span class="math inline">\(H_1) \ \tau_{1} \neq \tau_{2}\)</span></p></li>
<li><p>Efecto Club: <span class="math inline">\(H_0) \ \beta_{1} = \beta_{2}\)</span> vs.&nbsp;<span class="math inline">\(H_1) \ \beta_{1} \neq \beta_{2}\)</span></p></li>
</ul>
<p>En base a la evidencia muestral y con un nivel de significación del <span class="math inline">\(5\%\)</span>, se concluye que el deporte que practica el deportista influye significativamente sobre el resultado en el test de coordinación. En cambio, el club en el cual entrenan no influye significativamente sobre la respuesta.</p>
<section id="comparaciones-múltiples-1" class="level2">
<h2 class="anchored" data-anchor-id="comparaciones-múltiples-1">Comparaciones múltiples</h2>
<p>En este caso, como el único efecto principal que resultó significativo fue ‘Deporte’ y este sólo tiene dos niveles no tendría sentido realizar comparaciones múltiples. A fines de mostrar como se continuaría el análisis, se presentan comparaciones múltiples pensando en que la interacción entre los factores hubiera sido significativa. Se comparan 6 medias, cruzando los niveles de ambos factores: <span class="math inline">\(H_0) \ \mu_{ij} = \mu_{i'j'}\)</span> versus <span class="math inline">\(H_1) \ \mu_{ij} \neq \mu_{i'j'}, \ \forall \ i &lt; i' \ , \ j&lt;j'\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, pairwise<span class="sc">~</span>deporte<span class="sc">*</span>club, <span class="at">adjust=</span><span class="st">"tukey"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(cm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 deporte    club                     emmean    SE df lower.CL upper.CL
 Básquetbol CLUB ATLÉTICO LIBERTAD     14.5 0.268 65     14.0     15.0
 Volleyball CLUB ATLÉTICO LIBERTAD     16.3 0.289 65     15.7     16.9
 Básquetbol CLUB ATLETICO PROVINCIAL   14.6 0.268 65     14.1     15.1
 Volleyball CLUB ATLETICO PROVINCIAL   16.5 0.186 65     16.1     16.8

Confidence level used: 0.95 

$contrasts
 contrast                                                                 
 Básquetbol CLUB ATLÉTICO LIBERTAD - Volleyball CLUB ATLÉTICO LIBERTAD    
 Básquetbol CLUB ATLÉTICO LIBERTAD - Básquetbol CLUB ATLETICO PROVINCIAL  
 Básquetbol CLUB ATLÉTICO LIBERTAD - Volleyball CLUB ATLETICO PROVINCIAL  
 Volleyball CLUB ATLÉTICO LIBERTAD - Básquetbol CLUB ATLETICO PROVINCIAL  
 Volleyball CLUB ATLÉTICO LIBERTAD - Volleyball CLUB ATLETICO PROVINCIAL  
 Básquetbol CLUB ATLETICO PROVINCIAL - Volleyball CLUB ATLETICO PROVINCIAL
 estimate    SE df lower.CL upper.CL
   -1.815 0.394 65   -2.854   -0.776
   -0.104 0.379 65   -1.102    0.895
   -1.973 0.326 65   -2.833   -1.114
    1.712 0.394 65    0.673    2.751
   -0.158 0.344 65   -1.064    0.749
   -1.869 0.326 65   -2.729   -1.010

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
</div>
<p>Como era de esperarse, las comparaciones que resultan significatiavas (el intervalo de confianza de los pares comparados no cubre al cero) son las que comparan diferentes deportes.</p>
<p>El análisis se finaliza con la comprobación de los supuestos de normalidad, homocedasticidad e independencia.</p>
</section>
</section>
<section id="anova-para-dos-criterios-de-clasificación-cruzados-con-interacción" class="level1">
<h1>ANOVA para dos criterios de clasificación cruzados con interacción</h1>
<p>Análisis en el que se presentan dos <strong>factores de clasificación (con dos o más niveles cada uno)</strong>. El término <em>cruzado</em> indica que cada nivel de un factor puede combinarse con cada nivel del otro factor. El objetivo es conocer si estos factores influyen en el comportamiento de una <strong>variable (respuesta) continua y gaussiana</strong> a través de un <strong>Análisis de la Variancia</strong> (ANOVA).</p>
<p>Steel y Torrie (1980, págs. 217-218) informaron datos (cortesía de A.c. Linnerud, Universidad Estatal de Carolina del Norte) sobre los tiempos (en segundos) para completar un recorrido de 1,5 millas. Todos los corredores eran hombres clasificados en tres grupos de edad y en tres categorías de fitness.</p>
<ul>
<li>Factor 1: Grupo etario (40-50-60)</li>
<li>Factor 2: Categoría de fitness (baja-media-alta)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base_fitness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  edad categoria tiempo
1   40      baja    669
2   40      baja    671
3   40     media    602
4   40     media    603
5   40      alta    527
6   40      alta    547</code></pre>
</div>
</div>
<p>Se estudian medidas descriptivas y gráficos de boxplots y perfiles para los corredores según edad y categoría.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Medidas descriptivas</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>base_fitness <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(edad, categoria) <span class="sc">%&gt;%</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">media =</span> <span class="fu">mean</span>(tiempo),</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">desvio =</span> <span class="fu">sd</span>(tiempo)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 5
# Groups:   edad [3]
  edad  categoria     n media desvio
  &lt;chr&gt; &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 40    alta          2    NA 14.1  
2 40    baja          2    NA  1.41 
3 40    media         2    NA  0.707
4 50    alta          2    NA  1.41 
5 50    baja          2    NA 32.5  
6 50    media         2    NA  2.12 
7 60    alta          2    NA 17.7  
8 60    baja          2    NA 36.1  
9 60    media         2    NA  2.83 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots. Ojo! Sólo hay dos observaciones por grupo</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(base_fitness, <span class="fu">aes</span>(<span class="at">x =</span> edad, <span class="at">y =</span> tiempo)) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>categoria) <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#4271AE"</span>, <span class="at">colour =</span> <span class="st">"#1F3552"</span>, </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Tiempo"</span>, <span class="at">x=</span><span class="st">"Edad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de perfiles (para evaluar interacción entre factores)</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>base_fitness <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(edad, categoria) <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">media =</span> <span class="fu">mean</span>(tiempo)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>edad,<span class="at">y=</span>media,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">group=</span>categoria,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span>categoria)) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Media"</span>, <span class="at">x=</span><span class="st">"Edad"</span>,<span class="at">color=</span><span class="st">"Categoria"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se puede observar que los tiempos en realizar la prueba de 1.5 millas …</p>
<p>Se plantea el siguiente modelo de efectos fijos:<br>
</p>
<p><span class="math inline">\(y_{ijk} = \mu + \tau_i + \beta_j + (\tau \beta)_{ij} + e_{ijk}, \ i=\overline{1,3} \ \land \ j=\overline{1,3}\ \land \ k=\overline{1,2}\)</span>, donde:</p>
<ul>
<li><p><span class="math inline">\(y_{ijk}\)</span>: tiempo en realizar la prueba de 1.5 millas del <span class="math inline">\(k-ésimo\)</span> corredor con <span class="math inline">\(i\)</span> años de la categoría <span class="math inline">\(j\)</span>.</p></li>
<li><p><span class="math inline">\(\mu\)</span>: valor de referencia del tiempo en realizar la prueba de 1.5 millas.</p></li>
<li><p><span class="math inline">\(\tau_i\)</span>: efecto edad <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_j\)</span>: efecto categoría <span class="math inline">\(j\)</span>.</p></li>
<li><p><span class="math inline">\((\tau \beta)_{ij}\)</span>: efecto interacción entre el edad <span class="math inline">\(i\)</span> y el categoría <span class="math inline">\(j\)</span>.</p></li>
<li><p><span class="math inline">\(e_{ijk}\)</span>: error aleatorio del <span class="math inline">\(k-ésimo\)</span> corredor con <span class="math inline">\(i\)</span> años de la categoría <span class="math inline">\(j\)</span>.</p></li>
</ul>
<p>Además, <span class="math inline">\(e_{ijk} \sim \mathcal{N}(0,\sigma^2)\)</span> <em>e independientes.</em></p>
<p>En este modelo, a través de la interacción, se postula que el efecto de la edad del corredor en el tiempo que tarda en alcanzar las 1.5 millas depende de su categoría.</p>
<p>A continuación, se muestra la tabla ANOVA:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla ANOVA</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(tiempo<span class="sc">~</span>edad<span class="sc">*</span>categoria, base_fitness)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
edad            2 195733   97866  304.99 5.39e-09 ***
categoria       2 160867   80434  250.66 1.28e-08 ***
edad:categoria  4  21752    5438   16.95 0.000321 ***
Residuals       9   2888     321                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo estimado</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(tiempo<span class="sc">~</span>edad<span class="sc">*</span>categoria, base_fitness)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tiempo ~ edad * categoria, data = base_fitness)

Residuals:
    Min      1Q  Median      3Q     Max 
-25.500  -1.875   0.000   1.875  25.500 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             537.00      12.67  42.395 1.13e-11 ***
edad50                   35.00      17.91   1.954  0.08246 .  
edad60                  163.50      17.91   9.127 7.61e-06 ***
categoriabaja           133.00      17.91   7.425 4.00e-05 ***
categoriamedia           65.50      17.91   3.656  0.00526 ** 
edad50:categoriabaja     93.00      25.33   3.671  0.00515 ** 
edad60:categoriabaja    201.00      25.33   7.934 2.36e-05 ***
edad50:categoriamedia    48.00      25.33   1.895  0.09065 .  
edad60:categoriamedia    60.00      25.33   2.368  0.04202 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.91 on 9 degrees of freedom
Multiple R-squared:  0.9924,    Adjusted R-squared:  0.9857 
F-statistic: 147.4 on 8 and 9 DF,  p-value: 1.257e-08</code></pre>
</div>
</div>
<p>El test de hipótesis para responder al efecto interacción se plantea como: <span class="math inline">\(H_0)\)</span> No hay interacción versus <span class="math inline">\(H_1)\)</span> Hay interacción. Que no haya interacción es que el efecto edad es el mismo para cualquier categoría.</p>
<p>En base a la evidencia muestral y con un nivel de significación del <span class="math inline">\(5\%\)</span>, se rechaza la hipótesis nula, es decir, hay efecto interacción entre edad y categoría. El efecto de la edad sobre el cambio del tiempo en realizar las 1.5 millas de los corredores depende de la categoría en la que se encuentran.</p>
<p>Como la interacción del modelo resultó significativa, no se prueban los efectos principales.</p>
<section id="comparaciones-múltiples-2" class="level2">
<h2 class="anchored" data-anchor-id="comparaciones-múltiples-2">Comparaciones múltiples</h2>
<p>Para comparar los niveles de edad dentro de cada categoría y viceversa, planteamos las siguientes comparaciones:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">joint_tests</span>(modelo, <span class="at">by =</span> <span class="st">"edad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>edad = 40:
 model term df1 df2 F.ratio p.value
 categoria    2   9  27.565  0.0001

edad = 50:
 model term df1 df2 F.ratio p.value
 categoria    2   9  79.586  &lt;.0001

edad = 60:
 model term df1 df2 F.ratio p.value
 categoria    2   9 177.401  &lt;.0001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">joint_tests</span>(modelo, <span class="at">by =</span> <span class="st">"categoria"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>categoria = alta:
 model term df1 df2 F.ratio p.value
 edad         2   9  46.194  &lt;.0001

categoria = baja:
 model term df1 df2 F.ratio p.value
 edad         2   9 213.133  &lt;.0001

categoria = media:
 model term df1 df2 F.ratio p.value
 edad         2   9  79.551  &lt;.0001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>emm_s.t <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, pairwise <span class="sc">~</span> edad <span class="sc">|</span> categoria)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>emm_s.t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
categoria = alta:
 edad emmean   SE df lower.CL upper.CL
 40      537 12.7  9      508      566
 50      572 12.7  9      543      601
 60      700 12.7  9      672      729

categoria = baja:
 edad emmean   SE df lower.CL upper.CL
 40      670 12.7  9      641      699
 50      798 12.7  9      769      827
 60     1034 12.7  9     1006     1063

categoria = media:
 edad emmean   SE df lower.CL upper.CL
 40      602 12.7  9      574      631
 50      686 12.7  9      657      714
 60      826 12.7  9      797      855

Confidence level used: 0.95 

$contrasts
categoria = alta:
 contrast        estimate   SE df t.ratio p.value
 edad40 - edad50      -35 17.9  9  -1.954  0.1795
 edad40 - edad60     -164 17.9  9  -9.127  &lt;.0001
 edad50 - edad60     -128 17.9  9  -7.173  0.0001

categoria = baja:
 contrast        estimate   SE df t.ratio p.value
 edad40 - edad50     -128 17.9  9  -7.146  0.0001
 edad40 - edad60     -364 17.9  9 -20.348  &lt;.0001
 edad50 - edad60     -236 17.9  9 -13.202  &lt;.0001

categoria = media:
 contrast        estimate   SE df t.ratio p.value
 edad40 - edad50      -83 17.9  9  -4.633  0.0032
 edad40 - edad60     -224 17.9  9 -12.477  &lt;.0001
 edad50 - edad60     -140 17.9  9  -7.843  0.0001

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>emm_s.t1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, pairwise <span class="sc">~</span> categoria <span class="sc">|</span> edad)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>emm_s.t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
edad = 40:
 categoria emmean   SE df lower.CL upper.CL
 alta         537 12.7  9      508      566
 baja         670 12.7  9      641      699
 media        602 12.7  9      574      631

edad = 50:
 categoria emmean   SE df lower.CL upper.CL
 alta         572 12.7  9      543      601
 baja         798 12.7  9      769      827
 media        686 12.7  9      657      714

edad = 60:
 categoria emmean   SE df lower.CL upper.CL
 alta         700 12.7  9      672      729
 baja        1034 12.7  9     1006     1063
 media        826 12.7  9      797      855

Confidence level used: 0.95 

$contrasts
edad = 40:
 contrast     estimate   SE df t.ratio p.value
 alta - baja    -133.0 17.9  9  -7.425  0.0001
 alta - media    -65.5 17.9  9  -3.656  0.0131
 baja - media     67.5 17.9  9   3.768  0.0111

edad = 50:
 contrast     estimate   SE df t.ratio p.value
 alta - baja    -226.0 17.9  9 -12.616  &lt;.0001
 alta - media   -113.5 17.9  9  -6.336  0.0004
 baja - media    112.5 17.9  9   6.280  0.0004

edad = 60:
 contrast     estimate   SE df t.ratio p.value
 alta - baja    -334.0 17.9  9 -18.645  &lt;.0001
 alta - media   -125.5 17.9  9  -7.006  0.0002
 baja - media    208.5 17.9  9  11.639  &lt;.0001

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>El análisis se finaliza con la comprobación de los supuestos de normalidad, homocedasticidad e independencia.</p>
</section>
</section>
<section id="anova-para-factores-anidados" class="level1">
<h1>ANOVA para factores anidados</h1>
<p>Damon y Harvey (1987, p.&nbsp;26) presentaron datos sobre el aumento de peso de pollos sometidos a cuatro tratamientos de alimentación. Los datos originales fueron proporcionados por el Dr.&nbsp;Donald L. Anderson del Departamento de Veterinaria y Ciencias Animales de la Universidad de Massachusetts.</p>
<p>El experimento implicó la determinación de las ganancias de peso (en gramos) de 10 a 20 semanas de pollos colocados en cuatro tratamientos de alimentación obtenidos de combinaciones de calcio y lisina altos y bajos. Las determinaciones de peso se realizaron utilizando seis pollos en dos corrales de cada uno de los cuatro tratamientos de alimentación. Se puede considerar que los corrales se encuentran anidados dentro de cada tratamientos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pollos <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"C:/Users/Usuario/Desktop/Facultad Flor/Anova/pollos.xlsx"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"text"</span>, </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>, <span class="st">"numeric"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se realiza un análisis descriptivo para estudiar la relación entre los tratamientos, los corrales y el aumento de peso de los pollos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pollos, <span class="fu">aes</span>(<span class="at">x =</span> corral, <span class="at">y =</span> peso))<span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>tratamiento)<span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se plantea el siguiente modelo de efectos fijos:<br>
</p>
<p><span class="math inline">\(y_{ijk} = \mu + \tau_i + \beta_{j(i)} + e_{ijk}, \ i=\overline{1,4} \ \land \ j=\overline{1,2}\ \land \ k=\overline{1,6}\)</span>, donde:</p>
<ul>
<li><p><span class="math inline">\(y_{ijk}\)</span>: aumento en el peso del <span class="math inline">\(k-ésimo\)</span> pollo sometidos al <span class="math inline">\(i-ésimo\)</span> tratamiento en el corral <span class="math inline">\(j-ésimo\)</span>.</p></li>
<li><p><span class="math inline">\(\mu\)</span>: valor de referencia del aumento en el peso.</p></li>
<li><p><span class="math inline">\(\tau_i\)</span>: efecto del tratamiento <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_{j(i)}\)</span>: efecto del corral <span class="math inline">\(j\)</span> correspondiente al tratamiento <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(e_{ijk}\)</span>: error aleatorio del <span class="math inline">\(k-ésimo\)</span> pollo sometidos al <span class="math inline">\(i-ésimo\)</span> tratamiento en el corral <span class="math inline">\(j-ésimo\)</span>.</p></li>
</ul>
<p>Además, <span class="math inline">\(e_{ijk} \sim \mathcal{N}(0,\sigma^2)\)</span> <em>e independientes.</em></p>
<p>En este modelo se postula que los corrales se encuentran anidados a los tratamientos.</p>
<p>La tabla ANOVA del modelo considerado es el siguiente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla ANOVA</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(peso <span class="sc">~</span> tratamiento<span class="sc">/</span>corral, pollos)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Df Sum Sq Mean Sq F value Pr(&gt;F)
tratamiento         3  53943   17981   0.732  0.539
tratamiento:corral  4 125688   31422   1.279  0.294
Residuals          40 982654   24566               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo estimado</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(peso <span class="sc">~</span> tratamiento<span class="sc">/</span>corral, pollos)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = peso ~ tratamiento/corral, data = pollos)

Residuals:
    Min      1Q  Median      3Q     Max 
-401.50  -77.42  -24.33  109.00  280.33 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                  706.83      63.99  11.046 1.01e-13 ***
tratamientoHiCaLoL            81.17      90.49   0.897   0.3751    
tratamientoLoCaHiL            28.83      90.49   0.319   0.7517    
tratamientoLoCaLoL           -14.17      90.49  -0.157   0.8764    
tratamientoHiCaHiL:corral2   -86.83      90.49  -0.960   0.3430    
tratamientoHiCaLoL:corral2  -168.00      90.49  -1.857   0.0708 .  
tratamientoLoCaHiL:corral2    38.83      90.49   0.429   0.6701    
tratamientoLoCaLoL:corral2    68.00      90.49   0.751   0.4568    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 156.7 on 40 degrees of freedom
Multiple R-squared:  0.1546,    Adjusted R-squared:  0.006597 
F-statistic: 1.045 on 7 and 40 DF,  p-value: 0.4163</code></pre>
</div>
</div>
<p>En base a la evidencia muestral, con un nivel de significación del 5%, se concluye que no hay efecto significativo de los corrales sobre el aumento de peso de los pollos. Además, los tratamientos no muestran diferencias significativas en la respuesta estudiada.</p>
<p>En el caso de que el efecto tratamiento sea significativo, se podría continuar realizando comparaciones múltiples o contrastes.</p>
<p>El análisis se finaliza con la comprobación de los supuestos de normalidad, homocedasticidad e independencia.</p>
<div>






</div></section>

</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>